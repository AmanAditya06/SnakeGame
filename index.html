<!DOCTYPE html>
<html>
<head>
  <title>Snake Game</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />    
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <style>
    
  @import url('https://fonts.googleapis.com/css2?family=Pangolin&display=swap');

    /* CSS styles */
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #f2f2f2;
      font-family: Arial, sans-serif;
    }
    
    #game-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: #333;
      border-radius: 8px;
      padding: 20px;
    }
    
    #game-board {
      position: relative;
      width: 400px;
      height: 400px;
      border: 2px solid #fff;
      background-color: #abfa93;
      margin-bottom: 20px;
    }

    .pause-icon {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(50%, 50%);
      font-size: 40px;
      color: rgb(16, 1, 1);
      z-index: 2;
    }

    .snake-dot {
      position: absolute;
      width: 20px;
      height: 20px;
      background-color: rgb(96, 3, 126);
      border-radius: 50%;
    }
    
    .food-dot {
      position: absolute;
      width: 20px;
      height: 20px;
      background-color: rgb(255, 0, 0);
      border-radius: 50%;
    }
    
    #scoreboard {
      display: flex;
      justify-content: space-between;
      width: 100%;
      color: #fff;
      font-family: 'Pangolin', cursive;
    }
    
    #score,
    #high-score {
      font-size: 20px;
    }
    
    #score-label,
    #high-score-label {
      font-weight: bold;
    }
    
    h1 {
      color: #fff;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      font-family: 'Pangolin', cursive;
    }
    
    .snake-mascot {
      width: 40px;
      height: 40px;
      margin-right: 10px;
      border-radius: 8px;
    }
    
    .celebration {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(255, 255, 255, 0.7);
      z-index: 999;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 36px;
      color: #ff9900;
      font-weight: bold;
      animation: celebrate 9s ease-in-out;
    }
    
    @keyframes celebrate {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.2);
      }
    }
  </style>
</head>
<body>
  <div id="game-container">
    <h1>
      <img class="snake-mascot" src="snake-mascot.png" alt="Snake Mascot">
      Snake Game
    </h1>
    <div id="game-board">
        <!-- Add pause icon -->
        <div id="pause-icon" class="pause-icon">
            <span class="material-symbols-outlined">
                play_circle
            </span>
        </div>
    </div>
    <div id="scoreboard">
      <div>
        <span id="score-label">Score:</span>
        <span id="score">0</span>
      </div>
      <div>
        <span id="high-score-label">High Score:</span>
        <span id="high-score">0</span>
      </div>
    </div>
  </div>
  
  <script>
    // JavaScript code
    const gameContainer = document.getElementById("game-container");
    const gameBoard = document.getElementById("game-board");
    const pauseIcon = document.getElementById("pause-icon");
    const scoreElement = document.getElementById("score");
    const highScoreElement = document.getElementById("high-score");
    const snakeSize = 20;
    const boardSize = 400;
    let snake = [{x: 200, y: 200}];
    let direction = "right";
    let food = {x: 0, y: 0};
    let lastRenderTime = 0;
    let speed = 100; // Speed control (milliseconds)
    let score = 0;
    let highScore = getHighScoreFromLocalStorage(); // Retrieve the high score from local storage
    draw();
    let isPaused = true;
    pauseIcon.style.display = "block";
    let pauseKey = " "; // Spacebar key

    // Function to retrieve the high score from local storage
    function getHighScoreFromLocalStorage() {
    const storedHighScore = localStorage.getItem("highScore");
    if (storedHighScore) {
        return parseInt(storedHighScore);
    }
    return 0;
    }

    // Function to save the high score to local storage
    function saveHighScoreToLocalStorage() {
    localStorage.setItem("highScore", highScore.toString());
    }
    
    function gameLoop(currentTime) {
      const deltaTime = currentTime - lastRenderTime;
      if (isPaused) {
        requestAnimationFrame(gameLoop);
        return;
      }
      
      if (deltaTime < speed) {
        requestAnimationFrame(gameLoop);
        return;
      }
      highScore = getHighScoreFromLocalStorage(); // Retrieve the high score from local storage
      lastRenderTime = currentTime;
      update();
      draw();
      requestAnimationFrame(gameLoop);
    }
    
    function update() {
      updateSnake();
      checkCollision();
      checkFoodCollision();
    }
    
    function draw() {
      gameBoard.innerHTML = "";
      
      snake.forEach((dot) => {
        const snakeDot = createDot(dot.x, dot.y, "snake-dot");
        gameBoard.appendChild(snakeDot);
      });
      
      const foodDot = createDot(food.x, food.y, "food-dot");
      gameBoard.appendChild(foodDot);
    }
    
    function updateSnake() {
      const head = {x: snake[0].x, y: snake[0].y};
      
      if (direction === "right") {
        head.x += snakeSize;
      } else if (direction === "left") {
        head.x -= snakeSize;
      } else if (direction === "up") {
        head.y -= snakeSize;
      } else if (direction === "down") {
        head.y += snakeSize;
      }
      
      snake.unshift(head);
      
      if (!checkFoodCollision()) {
        snake.pop();
      }
    }
    
    function checkFoodCollision() {
      const head = snake[0];
      
      if (head.x === food.x && head.y === food.y) {
        score++;
        updateScore();
        generateFood();
        return true;
      }
      
      return false;
    }
    
    function generateFood() {
      const maxX = boardSize - snakeSize;
      const maxY = boardSize - snakeSize;
      food.x = Math.floor(Math.random() * maxX / snakeSize) * snakeSize;
      food.y = Math.floor(Math.random() * maxY / snakeSize) * snakeSize;
    }
    
    function checkCollision() {
      const head = snake[0];
      
      if (
        head.x < 0 ||
        head.x >= boardSize ||
        head.y < 0 ||
        head.y >= boardSize
      ) {
        gameOver();
        return;
      }
      
      for (let i = 1; i < snake.length; i++) {
        if (head.x === snake[i].x && head.y === snake[i].y) {
          gameOver();
          return;
        }
      }
    }
    
    function gameOver() {
      isGameOver = true;
    if (score > highScore) {
        highScore = score;
        updateHighScore();
        celebrate();
    } else {
        alert("Game Over! Your score: " + score);
    
        snake = [{x: 200, y: 200}];
        direction = "right";
        generateFood();
        score = 0;
        updateScore();
    }
    }
    
    function celebrate() {
    const celebration = document.createElement("div");
    celebration.textContent = "New High Score!";
    celebration.classList.add("celebration");
    gameContainer.appendChild(celebration);

    setTimeout(() => {
        celebration.classList.remove("celebration");
        celebration.remove();
        alert("Congratulations! You achieved a new high score!");
    }, 2000);
    }
    
    function createDot(x, y, className) {
      const dot = document.createElement("div");
      dot.style.left = x + "px";
      dot.style.top = y + "px";
      dot.className = className;
      return dot;
    }
    
    function updateScore() {
      scoreElement.textContent = score;
    }
    
    function updateHighScore() {
    highScoreElement.textContent = highScore;
    saveHighScoreToLocalStorage(); // Save the high score to local storage
    }
    
    document.addEventListener("keydown", function(event) {
      if (event.key === "ArrowRight" && direction !== "left") {
        direction = "right";
      } else if (event.key === "ArrowLeft" && direction !== "right") {
        direction = "left";
      } else if (event.key === "ArrowUp" && direction !== "down") {
        direction = "up";
      } else if (event.key === "ArrowDown" && direction !== "up") {
        direction = "down";
      } else if (event.key === pauseKey) {
        togglePause();
      }
    });
    
    function togglePause() {
      isPaused = !isPaused;
      if (isPaused) {
        pauseIcon.style.display = "block";
      } else {
        pauseIcon.style.display = "none";
        requestAnimationFrame(gameLoop);
      }
    }
    
    generateFood();
    updateScore();
    updateHighScore();
    requestAnimationFrame(gameLoop);
  </script>
</body>
</html>
